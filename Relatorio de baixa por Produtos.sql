-- Vers√£o com inner join no SD2
 
SELECT 
	E1.R_E_C_N_O_ AS E1_REC, 
	E5.R_E_C_N_O_ AS E5_REC, 
	D2.R_E_C_N_O_ AS D2_REC, 
	E1.E1_FILORIG AS FILIAL, 
	A1.A1_COD AS CLI_COD, 
	A1.A1_LOJA AS LOJA, 
	A1.A1_NOME AS CLI_NOME, 
	E1.E1_PREFIXO AS PREFIXO, 
	E1.E1_NUM AS DOCUMENTO, 
	E1.E1_PARCELA AS PARCELA, 
	E1.E1_TIPO AS TIPO, 
	E1.E1_NATUREZ AS NATUREZA, 
	E1.E1_EMISSAO AS EMISSAO, 
	E1.E1_VENCTO AS VENCIMENTO, 
	E1.E1_VENCREA AS VENC_REAL, 
	E1_NUMBCO AS BANCO, 
	E1.E1_SITUACA AS ST, 
	E1.E1_VALOR AS VALOR, 
	'' AS VL_ORIG, 
	'' AS VL_NOMINAL, 
	'' AS VL_CORRIG, 
	'' AS VL_VENCIDO, 
	'' AS VL_JUROS, 
	'' AS ATRASO, 
	CASE 
		WHEN E5.R_E_C_N_O_ <> 0 THEN E5.E5_HISTOR 
		WHEN D2.R_E_C_N_O_ <> 0 THEN '' ELSE E1.E1_HIST 
	END AS HISTORICO, 
	E1.E1_SALDO AS SALDO, 
	E1.E1_NUMBCO AS NUMBCO, 
	E1.E1_BAIXA AS ULTIMA_BAIXA, 
	E5.E5_DATA AS DATA_MOV, 
	E5.E5_VALOR AS VALOR_MOV, 
	E5.E5_BANCO AS BANCO_MOV, 
	E5.E5_AGENCIA AS AGENCIA_MOV, 
	E5.E5_CONTA AS CONTA_MOV, 
	E5.E5_DOCUMEN AS DOC_MOV, 
	E5.E5_MOTBX AS MOTV_BAIXA, 
	D2.D2_ITEM AS ITEM, 
	D2.D2_COD AS PROD_COD, 
	B1.B1_DESC AS PROD_DESCRI, 
	D2.D2_QUANT AS QUANTIDADE, 
	D2.D2_UM AS UNIDADE, 
	D2.D2_PRCVEN AS PRC_UNIT, 
	D2.D2_TOTAL AS PRC_ITEM, 
	CASE 
		WHEN 
			D2.D2_QUANT * D2.D2_PRCVEN = D2.D2_TOTAL 
		THEN 
			'ok' 
		ELSE 
			'ERR' 
	END 
	AS MULTIPLI_OK, 
	A3.A3_COD AS VEND_COD, 
	A3.A3_NOME AS VEND_NOME, 
	A3.A3_REGIAO AS VEND_REGI, 
	A3.A3_GEREN AS VEND_GER 
FROM 
	SE1010 E1 
	INNER JOIN 
		SD2010 D2 
		ON E1.E1_TIPO = 'NF' 
		AND E1.E1_NUM = D2.D2_DOC 
		AND E1.E1_FILORIG = D2.D2_FILIAL 
		AND D2.D_E_L_E_T_ = '' 
	INNER JOIN 
		SA1010 A1 
		ON E1.E1_CLIENTE = A1.A1_COD 
		AND E1.E1_LOJA = A1.A1_LOJA 
		AND A1.D_E_L_E_T_ = '' 
	INNER JOIN 
		SB1010 B1 
		ON D2.D2_COD = B1.B1_COD 
		AND B1.D_E_L_E_T_ = '' 
	LEFT JOIN 
		SA3010 A3 
		ON E1.E1_VEND1 = A3.A3_COD 
		AND A3.D_E_L_E_T_ = '' 
	LEFT JOIN 
		SE5010 E5 
		ON E1.E1_PREFIXO = E5.E5_PREFIXO 
		AND E1.E1_NUM = E5.E5_NUMERO 
		AND E1.E1_PARCELA = E5.E5_PARCELA 
		AND E1.E1_TIPO = E5.E5_TIPO 
		AND E1.E1_CLIENTE = E5.E5_CLIENTE 
		AND E1.E1_LOJA = E5.E5_LOJA 
		AND E1.E1_FILIAL = E5.E5_FILIAL 
		AND E5.D_E_L_E_T_ = '' 
WHERE 
	E1.E1_FILORIG IN ('FG01') 
	AND E1.E1_CLIENTE || '-' || E1.E1_LOJA IN ('084500310-0001', '000516169-0001', '004142810-0001', '103333160-0001', '445932640-0001', '220554560-0001', '204771690-0001', '005189690-0001', '042827500-0001') 
	AND E1.E1_SITUACA IN ('0', '1', '2', '3', '4', '5', '6', '7', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O') 
	AND E1.E1_SALDO <> 0 
	AND E1.D_E_L_E_T_ = '' 
ORDER BY 
	CLI_NOME, LOJA, DOCUMENTO, PARCELA, ITEM; 
 
-- Diamante
 
SELECT 
	REL.* 
FROM 
	(SELECT 
		* 
	FROM 
		(SELECT 
			E1.R_E_C_N_O_ AS E1_REC, 
			E5.R_E_C_N_O_ AS E5_REC, 
			0 AS D2_REC, 
			E1.E1_FILORIG AS FILIAL, 
			A1.A1_COD AS CLI_COD, 
			A1.A1_LOJA AS LOJA, 
			A1.A1_NOME AS CLI_NOME, 
			E1.E1_PREFIXO AS PREFIXO, 
			'' AS SERIE, 
			E1.E1_NUM AS DOCUMENTO, 
			E1.E1_PARCELA AS PARCELA, 
			'' AS ITEM, 
			E1.E1_TIPO AS TIPO, 
			E1.E1_NATUREZ AS NATUREZA, 
			E1.E1_EMISSAO AS EMISSAO, 
			E1.E1_VENCTO AS VENCIMENTO, 
			E1.E1_VENCREA AS VENC_REAL, 
			E1_NUMBCO AS BANCO, 
			E1.E1_SITUACA AS ST, 
			E1.E1_VALOR AS VALOR, 
			'' AS VL_ORIG, 
			'' AS VL_NOMINAL, 
			'' AS VL_CORRIG, 
			'' AS VL_VENCIDO, 
			'' AS VL_JUROS, 
			'' AS ATRASO, 
			CASE 
				WHEN E5.R_E_C_N_O_ <> 0 THEN E5.E5_HISTOR ELSE E1.E1_HIST 
			END AS HISTORICO, 
			E1.E1_SALDO AS SALDO, 
			E1.E1_NUMBCO AS NUMBCO, 
			E1.E1_BAIXA AS ULTIMA_BAIXA, 
			E5.E5_DATA AS DATA_MOV, 
			E5.E5_VALOR AS VALOR_MOV, 
			E5.E5_BANCO AS BANCO_MOV, 
			E5.E5_AGENCIA AS AGENCIA_MOV, 
			E5.E5_CONTA AS CONTA_MOV, 
			E5.E5_DOCUMEN AS DOC_MOV, 
			E5.E5_MOTBX AS MOTV_BAIXA, 
			'' AS PROD_COD, 
			'' AS PROD_DESCRI, 
			0 AS QUANTIDADE, 
			'' AS UNIDADE, 
			0 AS PRC_UNIT, 
			0 AS PRC_ITEM, 
			'' AS MULTIPLI_OK, 
			A3.A3_COD AS VEND_COD, 
			A3.A3_NOME AS VEND_NOME, 
			A3.A3_REGIAO AS VEND_REGI, 
			A3.A3_GEREN AS VEND_GER 
		FROM 
			SE1010 E1 
			INNER JOIN 
				SA1010 A1 
				ON E1.E1_CLIENTE = A1.A1_COD 
				AND E1.E1_LOJA = A1.A1_LOJA 
				AND A1.D_E_L_E_T_ = '' 
			LEFT JOIN 
				SA3010 A3 
				ON E1.E1_VEND1 = A3.A3_COD 
				AND A3.D_E_L_E_T_ = '' 
			LEFT JOIN 
				SE5010 E5 
				ON E1.E1_FILORIG = E5.E5_FILORIG 
				AND E1.E1_PREFIXO = E5.E5_PREFIXO 
				AND E1.E1_NUM = E5.E5_NUMERO 
				AND E1.E1_PARCELA = E5.E5_PARCELA 
				AND E1.E1_TIPO = E5.E5_TIPO 
				AND E1.E1_CLIENTE = E5.E5_CLIENTE 
				AND E1.E1_LOJA = E5.E5_LOJA 
				AND E1.E1_FILIAL = E5.E5_FILIAL 
				AND E5.D_E_L_E_T_ = '' 
		WHERE 
			E1.E1_TIPO = 'NF' 
			AND E1.E1_FILORIG IN ('FG01') 
			AND E1.E1_CLIENTE || '-' || E1.E1_LOJA IN ('084500310-0001', '000516169-0001', '004142810-0001', '103333160-0001', '445932640-0001', '220554560-0001', '204771690-0001', '005189690-0001', '042827500-0001') 
			AND E1.E1_SITUACA IN ('0', '1', '2', '3', '4', '5', '6', '7', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O') 
			AND E1.E1_SALDO <> 0 
			AND E1.D_E_L_E_T_ = '' 
		) RELE5 
	UNION 
	SELECT 
		* 
	FROM 
		(SELECT 
			E1.R_E_C_N_O_ AS E1_REC, 
			0 AS E5_REC, 
			D2.R_E_C_N_O_ AS D2_REC, 
			E1.E1_FILORIG AS FILIAL, 
			A1.A1_COD AS CLI_COD, 
			A1.A1_LOJA AS LOJA, 
			A1.A1_NOME AS CLI_NOME, 
			E1.E1_PREFIXO AS PREFIXO, 
			D2.D2_SERIE AS SERIE, 
			E1.E1_NUM AS DOCUMENTO, 
			E1.E1_PARCELA AS PARCELA, 
			D2.D2_ITEM AS ITEM, 
			E1.E1_TIPO AS TIPO, 
			E1.E1_NATUREZ AS NATUREZA, 
			E1.E1_EMISSAO AS EMISSAO, 
			E1.E1_VENCTO AS VENCIMENTO, 
			E1.E1_VENCREA AS VENC_REAL, 
			E1_NUMBCO AS BANCO, 
			E1.E1_SITUACA AS ST, 
			0 AS VALOR, 
			'' AS VL_ORIG, 
			'' AS VL_NOMINAL, 
			'' AS VL_CORRIG, 
			'' AS VL_VENCIDO, 
			'' AS VL_JUROS, 
			'' AS ATRASO, 
			'' AS HISTORICO, 
			0 AS SALDO, 
			'' AS NUMBCO, 
			E1.E1_BAIXA AS ULTIMA_BAIXA, 
			'' AS DATA_MOV, 
			0 AS VALOR_MOV, 
			'' AS BANCO_MOV, 
			'' AS AGENCIA_MOV, 
			'' AS CONTA_MOV, 
			'' AS DOC_MOV, 
			'' AS MOTV_BAIXA, 
			D2.D2_COD AS PROD_COD, 
			B1.B1_DESC AS PROD_DESCRI, 
			D2.D2_QUANT AS QUANTIDADE, 
			D2.D2_UM AS UNIDADE, 
			D2.D2_PRCVEN AS PRC_UNIT, 
			D2.D2_TOTAL AS PRC_ITEM, 
			CASE 
				WHEN 
					D2.D2_QUANT * D2.D2_PRCVEN = D2.D2_TOTAL 
				THEN 
					'ok' 
				ELSE 
					'ERR' 
			END 
			AS MULTIPLI_OK, 
			'' AS VEND_COD, 
			'' AS VEND_NOME, 
			'' AS VEND_REGI, 
			'' AS VEND_GER 
		FROM 
			SE1010 E1 
			INNER JOIN 
				SA1010 A1 
				ON E1.E1_CLIENTE = A1.A1_COD 
				AND E1.E1_LOJA = A1.A1_LOJA 
				AND A1.D_E_L_E_T_ = '' 
			INNER JOIN 
				SD2010 D2 
				ON E1.E1_NUM = D2.D2_DOC 
				AND E1.E1_FILORIG = D2.D2_FILIAL 
				AND E1.E1_CLIENTE = D2.D2_CLIENTE 
				AND D2.D_E_L_E_T_ = '' 
			INNER JOIN 
				SB1010 B1 
				ON D2.D2_COD = B1.B1_COD 
				AND B1.D_E_L_E_T_ = '' 
		WHERE 
			E1.E1_TIPO = 'NF' 
			AND E1.E1_FILORIG IN ('FG01') 
			AND E1.E1_CLIENTE || '-' || E1.E1_LOJA IN ('084500310-0001', '000516169-0001', '004142810-0001', '103333160-0001', '445932640-0001', '220554560-0001', '204771690-0001', '005189690-0001', '042827500-0001') 
			AND E1.E1_SITUACA IN ('0', '1', '2', '3', '4', '5', '6', '7', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O') 
			AND E1.E1_SALDO <> 0 
			AND E1.D_E_L_E_T_ = '' 
		) RELD2 
	) REL 
ORDER BY 
	CLI_NOME, LOJA, DOCUMENTO, PARCELA, ITEM, DATA_MOV; 
 
-- Somente E1E5

SELECT 
	E1.R_E_C_N_O_ AS E1_REC, 
	E5.R_E_C_N_O_ AS E5_REC, 
	E1.E1_FILORIG AS FILIAL, 
	A1.A1_COD AS CLI_COD, 
	A1.A1_LOJA AS LOJA, 
	A1.A1_NOME AS CLI_NOME, 
	E1.E1_PREFIXO AS PREFIXO, 
	E1.E1_NUM AS DOCUMENTO, 
	E1.E1_PARCELA AS PARCELA, 
	E1.E1_TIPO AS TIPO, 
	E1.E1_NATUREZ AS NATUREZA, 
	SUBSTRING(E1.E1_EMISSAO, 7, 2) || '/' || SUBSTRING(E1.E1_EMISSAO, 5, 2) || '/' || SUBSTRING(E1.E1_EMISSAO, 1, 4) AS EMISSAO, 
	SUBSTRING(E1.E1_VENCTO, 7, 2) || '/' || SUBSTRING(E1.E1_VENCTO, 5, 2) || '/' || SUBSTRING(E1.E1_VENCTO, 1, 4) AS VENCIMENTO, 
	SUBSTRING(E1.E1_VENCREA, 7, 2) || '/' || SUBSTRING(E1.E1_VENCREA, 5, 2) || '/' || SUBSTRING(E1.E1_VENCREA, 1, 4) AS VENC_REAL, 
	E1_NUMBCO AS BANCO, 
	E1.E1_SITUACA AS ST, 
	E1.E1_VALOR AS VL_ORIG, 
	'' AS VL_NOMINAL, 
	1.5 AS TX_JUROS, 
	DATEDIFF
	(
		DAY, 
		SUBSTRING(E1.E1_VENCREA, 1, 4) || '/' || SUBSTRING(E1.E1_VENCREA, 5, 2) || '/' || SUBSTRING(E1.E1_VENCREA, 7, 2), 
		GETDATE()
	) AS ATRASO, 
	CASE 
		WHEN E5.R_E_C_N_O_ <> 0 THEN E5.E5_HISTOR ELSE E1.E1_HIST 
	END AS HISTORICO, 
	E1.E1_SALDO AS SALDO, 
	E1.E1_NUMBCO AS NUMBCO, 
	E1.E1_BAIXA AS ULTIMA_BAIXA, 
	E5.E5_DATA AS DATA_MOV, 
	E5.E5_VALOR AS VALOR_MOV, 
	E5.E5_BANCO AS BANCO_MOV, 
	E5.E5_AGENCIA AS AGENCIA_MOV, 
	E5.E5_CONTA AS CONTA_MOV, 
	E5.E5_DOCUMEN AS DOC_MOV, 
	E5.E5_MOTBX AS MOTV_BAIXA, 
	'' AS PROD_COD, 
	A3.A3_COD AS VEND_COD, 
	A3.A3_NOME AS VEND_NOME, 
	A3.A3_REGIAO AS VEND_REGI, 
	A3.A3_GEREN AS VEND_GER 
FROM 
	SE1990 E1 
	INNER JOIN 
		SA1990 A1 
		ON E1.E1_CLIENTE = A1.A1_COD 
		AND E1.E1_LOJA = A1.A1_LOJA 
		AND A1.D_E_L_E_T_ = '' 
	LEFT JOIN 
		SA3990 A3 
		ON E1.E1_VEND1 = A3.A3_COD 
		AND A3.D_E_L_E_T_ = '' 
	LEFT JOIN 
		SE5990 E5 
		ON E1.E1_FILORIG = E5.E5_FILORIG 
		AND E1.E1_PREFIXO = E5.E5_PREFIXO 
		AND E1.E1_NUM = E5.E5_NUMERO 
		AND E1.E1_PARCELA = E5.E5_PARCELA 
		AND E1.E1_TIPO = E5.E5_TIPO 
		AND E1.E1_CLIENTE = E5.E5_CLIENTE 
		AND E1.E1_LOJA = E5.E5_LOJA 
		AND E1.E1_FILIAL = E5.E5_FILIAL 
		AND E5.D_E_L_E_T_ = '' 
WHERE 
	E1.E1_TIPO = 'NF' 
	AND E1.E1_FILORIG IN ('FG01') 
	AND E1.E1_CLIENTE || '-' || E1.E1_LOJA IN ('003724687-0001', '084500310-0001', '000516169-0001', '004142810-0001', '103333160-0001', '445932640-0001', '220554560-0001', '204771690-0001', '005189690-0001', '042827500-0001') 
	AND E1.E1_SITUACA IN ('0', '1', '2', '3', '4', '5', '6', '7', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O') 
	AND E1.E1_VENCTO BETWEEN '20251001' AND '20251031' 
	AND E1.E1_EMISSAO BETWEEN '20250810' AND '20250816' 
	AND E1.E1_SALDO <> 0 
	AND E1.D_E_L_E_T_ = '' 
ORDER BY 
	CLI_NOME, LOJA, DOCUMENTO, PARCELA, DATA_MOV; 


-- Somente E1

SELECT
	E1_EXT.E1_REC, 
	E1_EXT.FILIAL, 
	E1_EXT.CLI_COD, 
	E1_EXT.LOJA, 
	E1_EXT.CLI_NOME, 
	E1_EXT.PREFIXO, 
	E1_EXT.DOCUMENTO, 
	E1_EXT.PARCELA, 
	E1_EXT.TIPO, 
	E1_EXT.NATUREZA, 
	E1_EXT.EMISSAO, 
	E1_EXT.VENCIMENTO, 
	E1_EXT.VENC_REAL, 
	E1_EXT.BANCO, 
	E1_EXT.ST, 
	E1_EXT.CONTRATO, 
	E1_EXT.VL_ORIG, 
	E1_EXT.TX_JUROS, 
	E1_EXT.MULTA, 
	E1_EXT.ATRASO, 
	E1_EXT.E1_EMISSAO, 
	E1_EXT.E1_VENCREA, 
	E1_EXT.WEMISSAO, 
	E1_EXT.WVENCTO, 
	E1_EXT.QEMISSAO, 
	E1_EXT.QVENCTO, 
	E1_EXT.MEMISSAO, 
	E1_EXT.MVENCTO, 
	E1_EXT.SEMISSAO, 
	E1_EXT.SVENCTO, 
	E1_EXT.AEMISSAO, 
	E1_EXT.AVENCTO, 
	E1_EXT.SALDO, 
	E1_EXT.NUMBCO, 
	E1_EXT.ULTIMA_BAIXA, 
	E1_EXT.VEND_COD, 
	E1_EXT.VEND_NOME, 
	E1_EXT.VEND_REGI, 
	E1_EXT.VEND_GER, 
	CASE
		WHEN ATRASO > 0 THEN SALDO ELSE 0 
	END AS VL_VENCIDO, 
	CASE
		WHEN ATRASO > 0 THEN ROUND(SALDO * (TX_JUROS / 100) * (ATRASO / 30.5), 2) + MULTA + SALDO ELSE 0
	END AS VL_CORRIG,
	CASE
		WHEN ATRASO > 0 THEN ROUND(SALDO * (TX_JUROS / 100) * (ATRASO / 30.5), 2) ELSE 0
	END AS VL_JUROS 
FROM
	(
	SELECT 
		E1.R_E_C_N_O_ AS E1_REC, 
		E1.E1_FILORIG AS FILIAL, 
		A1.A1_COD AS CLI_COD, 
		A1.A1_LOJA AS LOJA, 
		A1.A1_NOME AS CLI_NOME, 
		E1.E1_PREFIXO AS PREFIXO, 
		E1.E1_NUM AS DOCUMENTO, 
		E1.E1_PARCELA AS PARCELA, 
		E1.E1_TIPO AS TIPO, 
		E1.E1_NATUREZ AS NATUREZA, 
		SUBSTR(E1.E1_EMISSAO, 7, 2) || '/' || SUBSTR(E1.E1_EMISSAO, 5, 2) || '/' || SUBSTR(E1.E1_EMISSAO, 1, 4) AS EMISSAO, 
		SUBSTR(E1.E1_VENCTO, 7, 2) || '/' || SUBSTR(E1.E1_VENCTO, 5, 2) || '/' || SUBSTR(E1.E1_VENCTO, 1, 4) AS VENCIMENTO, 
		SUBSTR(E1.E1_VENCREA, 7, 2) || '/' || SUBSTR(E1.E1_VENCREA, 5, 2) || '/' || SUBSTR(E1.E1_VENCREA, 1, 4) AS VENC_REAL, 
		E1_NUMBCO AS BANCO, 
		E1.E1_SITUACA AS ST, 
		E1.E1_CONTRAT AS CONTRATO, 
		E1.E1_VALOR AS VL_ORIG, 
		(E1.E1_PORCJUR * 100) AS TX_JUROS, 
		E1.E1_VLMULTA AS MULTA, 
		TRUNC(SYSDATE) - TO_DATE(E1.E1_VENCREA, 'YYYYMMDD') AS ATRASO, 
		E1.E1_EMISSAO, 
		E1.E1_VENCREA, 
		TRUNC((TO_DATE(E1.E1_EMISSAO, 'YYYYMMDD') - TO_DATE('19700101', 'YYYYMMDD')) / 7) AS WEMISSAO, 
		TRUNC((TO_DATE(E1.E1_VENCREA, 'YYYYMMDD') - TO_DATE('19700101', 'YYYYMMDD')) / 7) AS WVENCTO, 
		CASE
			WHEN SUBSTR(E1.E1_EMISSAO, 7, 2) <= 15
			THEN SUBSTR(E1.E1_EMISSAO, 1, 6) || '.1'
			ELSE SUBSTR(E1.E1_EMISSAO, 1, 6) || '.2'
		END AS QEMISSAO, 
		CASE
			WHEN SUBSTR(E1.E1_VENCREA, 7, 2) <= 15
			THEN SUBSTR(E1.E1_VENCREA, 1, 6) || '.1'
			ELSE SUBSTR(E1.E1_VENCREA, 1, 6) || '.2'
		END AS QVENCTO, 
		SUBSTR(E1.E1_EMISSAO, 1, 6) AS MEMISSAO, 
		SUBSTR(E1.E1_VENCREA, 1, 6) AS MVENCTO, 
		CASE
			WHEN SUBSTR(E1.E1_EMISSAO, 5, 2) <= 6
			THEN SUBSTR(E1.E1_EMISSAO, 1, 4) || '.1'
			ELSE SUBSTR(E1.E1_EMISSAO, 1, 4) || '.2'
		END AS SEMISSAO, 
		CASE
			WHEN SUBSTR(E1.E1_VENCREA, 5, 2) <= 6
			THEN SUBSTR(E1.E1_VENCREA, 1, 4) || '.1'
			ELSE SUBSTR(E1.E1_VENCREA, 1, 4) || '.2'
		END AS SVENCTO, 
		SUBSTR(E1.E1_EMISSAO, 1, 4) AS AEMISSAO, 
		SUBSTR(E1.E1_VENCREA, 1, 4) AS AVENCTO, 
		E1.E1_SALDO AS SALDO, 
		E1.E1_NUMBCO AS NUMBCO, 
		E1.E1_BAIXA AS ULTIMA_BAIXA, 
		A3.A3_COD AS VEND_COD, 
		A3.A3_NOME AS VEND_NOME, 
		A3.A3_REGIAO AS VEND_REGI, 
		A3.A3_GEREN AS VEND_GER 
	FROM 
		SE1010 E1 
		INNER JOIN 
			SA1010 A1 
			ON E1.E1_CLIENTE = A1.A1_COD 
			AND E1.E1_LOJA = A1.A1_LOJA 
			AND A1.D_E_L_E_T_ = '' 
		LEFT JOIN 
			SA3010 A3 
			ON E1.E1_VEND1 = A3.A3_COD 
			AND A3.D_E_L_E_T_ = '' 
	WHERE 
		E1.E1_TIPO = 'NF' 
		AND E1.E1_FILORIG IN ('FG01') 
		AND E1.E1_CLIENTE || '-' || E1.E1_LOJA IN ('003724687-0001', '084500310-0001', '000516169-0001', '004142810-0001', '103333160-0001', '445932640-0001', '220554560-0001', '204771690-0001', '005189690-0001', '042827500-0001') 
		AND E1.E1_SITUACA IN ('0', '1', '2', '3', '4', '5', '6', '7', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O') 
		AND E1.E1_VENCTO BETWEEN '20251001' AND '20251031' 
		AND E1.E1_EMISSAO BETWEEN '20250810' AND '20250816' 
		--AND E1.E1_USAFRA = '0002' 
		--AND E1.E1_UCULTUR = '2'
		AND E1.E1_SALDO <> 0 
		AND E1.D_E_L_E_T_ = '' 
	) E1_EXT
ORDER BY 
	CLI_NOME, LOJA, DOCUMENTO, PARCELA; 

-- Somente E5

SELECT 
	E5.R_E_C_N_O_ AS E5_REC, 
	E5.E5_PREFIXO AS PREFIXO, 
	E5.E5_NUMERO AS NUMERO, 
	E5.E5_PARCELA AS PARCELA, 
	SUBSTRING(E5.E5_DATA, 7, 2) || '/' || SUBSTRING(E5.E5_DATA, 5, 2) || '/' || SUBSTRING(E5.E5_DATA, 1, 4) AS DATA_MOV, 
	E5.E5_VALOR AS VALOR_MOV, 
	E5.E5_BANCO AS BANCO_MOV, 
	E5.E5_AGENCIA AS AGENCIA_MOV, 
	E5.E5_CONTA AS CONTA_MOV, 
	E5.E5_DOCUMEN AS DOC_MOV, 
	E5.E5_HISTOR AS HISTORICO, 
	E5.E5_MOTBX AS MOTV_BAIXA 
FROM 
	SE5990 E5
WHERE 
	E5.E5_FILORIG = 'E1_FILORIG' 
	AND E5.E5_PREFIXO = 'E1_PREFIXO' 
	AND E5.E5_NUMERO = 'E1_NUM' 
	AND E5.E5_PARCELA = 'E1_PARCELA' 
	AND E5.E5_TIPO = 'E1_TIPO' 
	AND E5.E5_CLIENTE = 'E1_CLIENTE' 
	AND E5.E5_LOJA = 'E1_LOJA' 
	AND E5.D_E_L_E_T_ = '' 
ORDER BY 
	DATA_MOV; 

-- Somente D2

SELECT 
	D2.R_E_C_N_O_ AS D2_REC, 
	D2.D2_FILIAL, 
	D2.D2_CLIENTE, 
	D2.D2_LOJA, 
	D2.D2_SERIE AS SERIE, 
	D2.D2_ITEM AS ITEM, 
	D2.D2_COD AS PROD_COD, 
	B1.B1_DESC AS PROD_DESCRI, 
	D2.D2_QUANT AS QUANTIDADE, 
	D2.D2_UM AS UNIDADE, 
	D2.D2_PRCVEN AS PRC_UNIT, 
	D2.D2_TOTAL AS PRC_ITEM, 
	D2.D2_QUANT * D2.D2_PRCVEN AS MULTIPLI_OK 
FROM 
	SD2010 D2 
	INNER JOIN 
		SB1010 B1 
		ON D2.D2_COD = B1.B1_COD 
		AND B1.D_E_L_E_T_ = '' 
WHERE 
	D2.D2_DOC = 'E1_NUM'
	AND D2.D2_FILIAL = 'E1_FILORIG' 
	AND D2.D2_CLIENTE = 'E1_CLIENTE' 
	AND D2.D2_LOJA = 'E1_LOJA'
	--AND B1.B1_GRUPO IN('2', '21', '2101') 
	--AND B1.B1_GRUPO IN('1') 
	--AND B1.B1_GRUPO IN('3', '32') 
	AND D2.D_E_L_E_T_ = '' 
ORDER BY
	ITEM; 